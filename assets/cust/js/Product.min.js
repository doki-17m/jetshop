function loadImage(r,e){const l='<img class="img-result"/>';formResult.show().append(l),"add"===e?$(".img-result").attr("src",CUST_URL+TMP+r):($(".img-result").attr("src",CUST_URL+IMAGE_PATH+r),formUpload.hide())}function deleteImage(r){url=SITE_URL+"/destroy_image";var e=0;"update"==setSave&&(e=ID),$.post(url,{src:r,set:setAction,id:e},function(r){imgSrc=0,$(".img-result").remove(),formResult.hide(),formUpload.show()})}function errFormPro(r){""!=r.error_pro_code?(errPCode.html(r.error_pro_code),fillPCode.addClass(isInvalid)):(errPCode.html(""),fillPCode.removeClass(isInvalid)),""!=r.error_pro_name?(errPName.html(r.error_pro_name),fillPName.addClass(isInvalid)):(errPName.html(""),fillPName.removeClass(isInvalid)),""!=r.error_pro_weight?(errPWeight.html(r.error_pro_weight),fillPWeight.addClass(isInvalid),msgPWeight.hide()):(errPWeight.html(""),fillPWeight.removeClass(isInvalid),msgPWeight.show()),""!=r.error_pro_minorder?(errPMinOrder.html(r.error_pro_minorder),fillPMinOrder.addClass(isInvalid)):(errPMinOrder.html(""),fillPMinOrder.removeClass(isInvalid)),""!=r.error_pro_purchidr?(errPPurch.html(r.error_pro_purchidr),fillPPurch.addClass(isInvalid)):(errPPurch.html(""),fillPPurch.removeClass(isInvalid)),""!=r.error_pro_slsidr?(errPSales.html(r.error_pro_slsidr),fillPSales.addClass(isInvalid)):(errPSales.html(""),fillPSales.removeClass(isInvalid))}function clearPro(){proForm[0].reset(),errPCode.html(""),errPName.html(""),errPWeight.html(""),errPMinOrder.html(""),errPPurch.html(""),errPSales.html(""),fillPCatg.val(null).change(),fillPUom.val(null).change(),fillPCode.removeClass(isInvalid),fillPName.removeClass(isInvalid),fillPWeight.removeClass(isInvalid),fillPMinOrder.removeClass(isInvalid),fillPPurch.removeClass(isInvalid),fillPSales.removeClass(isInvalid),$(".img-result").remove(),formResult.hide(),formUpload.show(),imgSrc=0}function chkdPro(){fillPCode.prop("readonly",!0),fillPName.prop("readonly",!0),fillPDesc.prop("readonly",!0),fillPWeight.prop("readonly",!0),fillPMinOrder.prop("readonly",!0),fillPPurch.prop("readonly",!0),fillPSales.prop("readonly",!0),fillPCatg.prop("disabled",!0),fillPUom.prop("disabled",!0)}function unchkdPro(){fillPCode.prop("readonly",!1),fillPName.prop("readonly",!1),fillPDesc.prop("readonly",!1),fillPWeight.prop("readonly",!1),fillPMinOrder.prop("readonly",!1),fillPPurch.prop("readonly",!1),fillPSales.prop("readonly",!1),fillPCatg.prop("disabled",!1),fillPUom.prop("disabled",!1)}function proCategory(){url=CUST_URL+CATEGORY+"/showCategory",$.getJSON(url,function(r){fillPCatg.append('<option selected="selected" value="">-- Choose One --</option>'),$.each(r,function(r,e){var l=e.m_product_category_id,o=e.name;fillPCatg.append('<option value="'+l+'">'+o+"</option>")})})}function proUom(){url=CUST_URL+UOM+"/showUom",$.getJSON(url,function(r){fillPUom.append('<option selected="selected" value="">-- Choose One --</option>'),$.each(r,function(r,e){var l=e.m_uom_id,o=e.name;fillPUom.append('<option value="'+l+'">'+o+"</option>")})})}const fillPCode=$("[name = pro_code]"),fillPName=$("[name = pro_name]"),fillPDesc=$("[name = pro_desc]"),fillPCatg=$("[name = pro_catg]"),fillPUom=$("[name = pro_uom]"),fillPWeight=$("[name = pro_weight]"),fillPMinOrder=$("[name = pro_minorder]"),fillPPurch=$("[name = pro_purchidr]"),fillPSales=$("[name = pro_slsidr]"),fillPImage=$("[name = pro_image]"),errPCode=$("#error_pro_code"),errPName=$("#error_pro_name"),errPWeight=$("#error_pro_weight"),errPMinOrder=$("#error_pro_minorder"),errPPurch=$("#error_pro_purchidr"),errPSales=$("#error_pro_slsidr"),msgPWeight=$("#msg_pro_weight"),formUResult=$("#form-upload-result"),formUpload=$("#form-upload"),formResult=$(".form-result"),btnDelImg=$("#btn_delimg"),IMAGE_PATH="/assets/cust/images/",TMP="/tmp/";proCategory(),proUom(),btnNewPro.click(function(){openModalForm(),Largemodal(),Scrollmodal(),modalTitle.text("New Product"),clearPro(),proActive.attr("checked",!0);const r=proForm[0].id;isActive(r),setSave="add"}),_tablePro.on("click","td:not(:last-child)",function(r){r.preventDefault();const e=proForm[0].id,l=_tablePro.row(this).data();ID=l[0];var o=l[3];openModalForm(),Scrollmodal(),Largemodal(),modalTitle.html(o),clearPro(),isActive(e),url=SITE_URL+SHOW+ID,setSave="update",$.getJSON(url,function(r){fillPCode.val(r.value),fillPName.val(r.name),fillPDesc.val(r.description),fillPCatg.val(r.m_product_category_id).change(),fillPUom.val(r.m_uom_id).change(),fillPWeight.val(r.weight),fillPMinOrder.val(r.minorder),fillPPurch.val(formatRupiah(r.costprice)),fillPSales.val(formatRupiah(r.sellprice));var l=r.ad_image_id;""!==l?(setAction=setSave,loadImage(l,setAction),imgSrc=l):setAction="add",r.isactive==active?(proActive.prop("checked",!0),readonly(e,!1)):(proActive.prop("checked",!1),readonly(e,!0))})}),fillPImage.change(function(r){r.preventDefault();var e=new FormData;const l=$(this).get(0).files[0];e.append("pro_image",l),url=SITE_URL+"/upload_image",$.ajax({url:url,type:"POST",data:e,processData:!1,contentType:!1,cache:!1,async:!1,dataType:"JSON",success:function(r){r.success?(setAction="add",loadImage(replaceChar(r.success),setAction),imgSrc=replaceChar(r.success),formUpload.hide()):(alert(replaceChar(r.error)),formUpload.show())},error:function(r,e,l){console.info(l),alert(l)}})}),btnDelImg.click(function(r){deleteImage(imgSrc)});