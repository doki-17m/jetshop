function loadImage(e,r){const l='<img class="img-result"/>';formResult.show().append(l),"add"===r?$(".img-result").attr("src",CUST_URL+TMP+e):($(".img-result").attr("src",CUST_URL+IMAGE_PATH+e),formUpload.hide())}function deleteImage(e){url=SITE_URL+"/destroy_image";var r=0;"update"==setSave&&(r=ID),$.post(url,{src:e,set:setAction,id:r},function(e){imgSrc=0,$(".img-result").remove(),formResult.hide(),formUpload.show()})}function errFormPro(e){""!=e.error_pro_code?(errPCode.html(e.error_pro_code),fillPCode.addClass(isInvalid)):(errPCode.html(""),fillPCode.removeClass(isInvalid)),""!=e.error_pro_name?(errPName.html(e.error_pro_name),fillPName.addClass(isInvalid)):(errPName.html(""),fillPName.removeClass(isInvalid)),""!=e.error_pro_weight?(errPWeight.html(e.error_pro_weight),fillPWeight.addClass(isInvalid),msgPWeight.hide()):(errPWeight.html(""),fillPWeight.removeClass(isInvalid),msgPWeight.show()),""!=e.error_pro_minorder?(errPMinOrder.html(e.error_pro_minorder),fillPMinOrder.addClass(isInvalid)):(errPMinOrder.html(""),fillPMinOrder.removeClass(isInvalid)),""!=e.error_pro_purchidr?(errPPurch.html(e.error_pro_purchidr),fillPPurch.addClass(isInvalid)):(errPPurch.html(""),fillPPurch.removeClass(isInvalid)),""!=e.error_pro_slsidr?(errPSales.html(e.error_pro_slsidr),fillPSales.addClass(isInvalid)):(errPSales.html(""),fillPSales.removeClass(isInvalid))}function clearPro(){proForm[0].reset(),errPCode.html(""),errPName.html(""),errPWeight.html(""),errPMinOrder.html(""),errPPurch.html(""),errPSales.html(""),fillPCatg.val(null).change(),fillPUom.val(null).change(),fillPCode.removeClass(isInvalid),fillPName.removeClass(isInvalid),fillPWeight.removeClass(isInvalid),fillPMinOrder.removeClass(isInvalid),fillPPurch.removeClass(isInvalid),fillPSales.removeClass(isInvalid),$(".img-result").remove(),formResult.hide(),formUpload.show(),imgSrc=0}function chkdPro(){fillPCode.prop("readonly",!0),fillPName.prop("readonly",!0),fillPDesc.prop("readonly",!0),fillPWeight.prop("readonly",!0),fillPMinOrder.prop("readonly",!0),fillPPurch.prop("readonly",!0),fillPSales.prop("readonly",!0),fillPCatg.prop("disabled",!0),fillPUom.prop("disabled",!0)}function unchkdPro(){fillPCode.prop("readonly",!1),fillPName.prop("readonly",!1),fillPDesc.prop("readonly",!1),fillPWeight.prop("readonly",!1),fillPMinOrder.prop("readonly",!1),fillPPurch.prop("readonly",!1),fillPSales.prop("readonly",!1),fillPCatg.prop("disabled",!1),fillPUom.prop("disabled",!1)}function proCategory(e,r){url=CUST_URL+CATEGORY+"/showCategory",$.getJSON(url,function(e){fillPCatg.empty(),fillPCatg.append('<option selected="selected" value="">-- Choose One --</option>'),$.each(e,function(e,l){var o=l.m_product_category_id,i=l.name;r==o?fillPCatg.append('<option value="'+o+'" selected="selected">'+i+"</option>"):fillPCatg.append('<option value="'+o+'">'+i+"</option>")})})}function proUom(e,r){url=CUST_URL+UOM+"/showUom",$.getJSON(url,function(l){fillPUom.empty(),fillPUom.append('<option selected="selected" value="">-- Choose One --</option>'),$.each(l,function(l,o){var i=o.m_uom_id,a=o.name;"add"==e?1==i||"PCS"===a?fillPUom.append('<option value="'+i+'" selected="selected">'+a+"</option>"):fillPUom.append('<option value="'+i+'">'+a+"</option>"):"update"==e&&r==i?fillPUom.append('<option value="'+i+'" selected="selected">'+a+"</option>"):fillPUom.append('<option value="'+i+'">'+a+"</option>")})})}const fillPCode=$("[name = pro_code]"),fillPName=$("[name = pro_name]"),fillPDesc=$("[name = pro_desc]"),fillPCatg=$("[name = pro_catg]"),fillPUom=$("[name = pro_uom]"),fillPWeight=$("[name = pro_weight]"),fillPMinOrder=$("[name = pro_minorder]"),fillPPurch=$("[name = pro_purchidr]"),fillPSales=$("[name = pro_slsidr]"),fillPImage=$("[name = pro_image]"),errPCode=$("#error_pro_code"),errPName=$("#error_pro_name"),errPWeight=$("#error_pro_weight"),errPMinOrder=$("#error_pro_minorder"),errPPurch=$("#error_pro_purchidr"),errPSales=$("#error_pro_slsidr"),msgPWeight=$("#msg_pro_weight"),formUResult=$("#form-upload-result"),formUpload=$("#form-upload"),formResult=$(".form-result"),btnDelImg=$("#btn_delimg"),IMAGE_PATH="/assets/cust/images/",TMP="/tmp/";btnNewPro.click(function(){openModalForm(),Largemodal(),Scrollmodal(),modalTitle.text("New Product"),clearPro(),proActive.attr("checked",!0);const e=proForm[0].id;isActive(e),setSave="add",proUom(setSave,0),proCategory(setSave,0)}),_tablePro.on("click","td:not(:last-child)",function(e){e.preventDefault();const r=proForm[0].id,l=_tablePro.row(this).data();ID=l[0];var o=l[3];openModalForm(),Scrollmodal(),Largemodal(),modalTitle.html(o),clearPro(),isActive(r),setSave="update",url=SITE_URL+SHOW+ID,$.getJSON(url,function(e){proCategory(setSave,e.m_product_category_id),proUom(setSave,e.m_uom_id),fillPCode.val(e.value),fillPName.val(e.name),fillPDesc.val(e.description),fillPWeight.val(e.weight),fillPMinOrder.val(e.minorder),fillPPurch.val(formatRupiah(e.costprice)),fillPSales.val(formatRupiah(e.sellprice));var l=e.ad_image_id;""!==l?(setAction=setSave,loadImage(l,setAction),imgSrc=l):setAction="add",e.isactive==active?(proActive.prop("checked",!0),readonly(r,!1)):(proActive.prop("checked",!1),readonly(r,!0))})}),fillPImage.change(function(e){e.preventDefault();var r=new FormData;const l=$(this).get(0).files[0];r.append("pro_image",l),url=SITE_URL+"/upload_image",$.ajax({url:url,type:"POST",data:r,processData:!1,contentType:!1,cache:!1,async:!1,dataType:"JSON",success:function(e){e.success?(setAction="add",loadImage(replaceChar(e.success),setAction),imgSrc=replaceChar(e.success),formUpload.hide()):(alert(replaceChar(e.error)),formUpload.show())},error:function(e,r,l){console.info(l),alert(l)}})}),btnDelImg.click(function(e){deleteImage(imgSrc)});